<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学习计划管理系统</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for icons */
        .icon {
            width: 1em;
            height: 1em;
            vertical-align: middle;
            fill: currentColor;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Icon components
        const Plus = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <path d="M12 5v14M5 12h14"/>
            </svg>
        );

        const Calendar = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
        );

        const Clock = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12,6 12,12 16,14"/>
            </svg>
        );

        const BookOpen = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
            </svg>
        );

        const Target = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="6"/>
                <circle cx="12" cy="12" r="2"/>
            </svg>
        );

        const CheckCircle = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <path d="m9 12 2 2 4-4"/>
                <circle cx="12" cy="12" r="10"/>
            </svg>
        );

        const XCircle = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10"/>
                <path d="m15 9-6 6"/>
                <path d="m9 9 6 6"/>
            </svg>
        );

        const Edit3 = () => (
            <svg className="icon" viewBox="0 0 24 24" fill="none">
                <path d="M12 20h9"/>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
            </svg>
        );

        function StudyPlanner() {
            const [subjects, setSubjects] = React.useState(() => {
                const saved = localStorage.getItem('studyPlannerSubjects');
                return saved ? JSON.parse(saved) : [];
            });
            
            const [tasks, setTasks] = React.useState(() => {
                const saved = localStorage.getItem('studyPlannerTasks');
                return saved ? JSON.parse(saved) : [];
            });
            
            const [newSubject, setNewSubject] = React.useState('');
            const [newTask, setNewTask] = React.useState({
                title: '',
                subject: '',
                priority: 'medium',
                deadline: '',
                estimatedHours: 1,
                description: ''
            });
            const [activeTab, setActiveTab] = React.useState('overview');

            // Save to localStorage whenever data changes
            React.useEffect(() => {
                localStorage.setItem('studyPlannerSubjects', JSON.stringify(subjects));
            }, [subjects]);

            React.useEffect(() => {
                localStorage.setItem('studyPlannerTasks', JSON.stringify(tasks));
            }, [tasks]);

            const addSubject = () => {
                if (newSubject.trim()) {
                    setSubjects([...subjects, {
                        id: Date.now(),
                        name: newSubject,
                        color: `hsl(${Math.random() * 360}, 70%, 60%)`
                    }]);
                    setNewSubject('');
                }
            };

            const addTask = () => {
                if (newTask.title && newTask.subject) {
                    setTasks([...tasks, {
                        ...newTask,
                        id: Date.now(),
                        completed: false,
                        createdAt: new Date().toISOString()
                    }]);
                    setNewTask({
                        title: '',
                        subject: '',
                        priority: 'medium',
                        deadline: '',
                        estimatedHours: 1,
                        description: ''
                    });
                }
            };

            const toggleTask = (id) => {
                setTasks(tasks.map(task => 
                    task.id === id ? { ...task, completed: !task.completed } : task
                ));
            };

            const deleteTask = (id) => {
                setTasks(tasks.filter(task => task.id !== id));
            };

            const getPriorityColor = (priority) => {
                switch(priority) {
                    case 'high': return 'text-red-600 bg-red-100';
                    case 'medium': return 'text-yellow-600 bg-yellow-100';
                    case 'low': return 'text-green-600 bg-green-100';
                    default: return 'text-gray-600 bg-gray-100';
                }
            };

            const getTaskStats = () => {
                const total = tasks.length;
                const completed = tasks.filter(t => t.completed).length;
                const pending = total - completed;
                const totalHours = tasks.reduce((sum, task) => sum + task.estimatedHours, 0);
                const completedHours = tasks.filter(t => t.completed).reduce((sum, task) => sum + task.estimatedHours, 0);
                
                return { total, completed, pending, totalHours, completedHours };
            };

            const stats = getTaskStats();

            return (
                <div className="max-w-6xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
                    <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                        {/* Header */}
                        <div className="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6">
                            <h1 className="text-3xl font-bold flex items-center gap-3">
                                <BookOpen />
                                学习计划管理系统
                            </h1>
                            <p className="mt-2 opacity-90">制定计划，追踪进度，提高学习效率</p>
                        </div>

                        {/* Navigation Tabs */}
                        <div className="border-b bg-gray-50">
                            <nav className="flex space-x-8 px-6">
                                {[
                                    { id: 'overview', label: '概览', icon: Target },
                                    { id: 'subjects', label: '学科管理', icon: BookOpen },
                                    { id: 'tasks', label: '任务管理', icon: Calendar },
                                    { id: 'add', label: '添加任务', icon: Plus }
                                ].map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`flex items-center gap-2 py-4 px-2 border-b-2 font-medium text-sm ${
                                            activeTab === tab.id
                                                ? 'border-blue-500 text-blue-600'
                                                : 'border-transparent text-gray-500 hover:text-gray-700'
                                        }`}
                                    >
                                        <tab.icon />
                                        {tab.label}
                                    </button>
                                ))}
                            </nav>
                        </div>

                        <div className="p-6">
                            {/* Overview Tab */}
                            {activeTab === 'overview' && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-gray-800">学习进度概览</h2>
                                    
                                    {/* Stats Cards */}
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                        <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-lg">
                                            <div className="flex items-center justify-between">
                                                <div>
                                                    <p className="text-blue-100">总任务</p>
                                                    <p className="text-2xl font-bold">{stats.total}</p>
                                                </div>
                                                <Target />
                                            </div>
                                        </div>
                                        
                                        <div className="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-lg">
                                            <div className="flex items-center justify-between">
                                                <div>
                                                    <p className="text-green-100">已完成</p>
                                                    <p className="text-2xl font-bold">{stats.completed}</p>
                                                </div>
                                                <CheckCircle />
                                            </div>
                                        </div>
                                        
                                        <div className="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-4 rounded-lg">
                                            <div className="flex items-center justify-between">
                                                <div>
                                                    <p className="text-orange-100">待完成</p>
                                                    <p className="text-2xl font-bold">{stats.pending}</p>
                                                </div>
                                                <Clock />
                                            </div>
                                        </div>
                                        
                                        <div className="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-lg">
                                            <div className="flex items-center justify-between">
                                                <div>
                                                    <p className="text-purple-100">总学时</p>
                                                    <p className="text-2xl font-bold">{stats.totalHours}h</p>
                                                </div>
                                                <BookOpen />
                                            </div>
                                        </div>
                                    </div>

                                    {/* Progress Bar */}
                                    {stats.total > 0 && (
                                        <div className="bg-gray-200 rounded-full h-4">
                                            <div 
                                                className="bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full transition-all duration-500"
                                                style={{ width: `${(stats.completed / stats.total) * 100}%` }}
                                            ></div>
                                            <p className="text-center mt-2 text-gray-600">
                                                完成进度: {stats.total > 0 ? Math.round((stats.completed / stats.total) * 100) : 0}%
                                            </p>
                                        </div>
                                    )}

                                    {/* Recent Tasks */}
                                    <div>
                                        <h3 className="text-lg font-semibold mb-3">近期任务</h3>
                                        <div className="space-y-2">
                                            {tasks.slice(0, 5).map(task => {
                                                const subject = subjects.find(s => s.name === task.subject);
                                                return (
                                                    <div key={task.id} className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                                                        <div 
                                                            className="w-3 h-3 rounded-full"
                                                            style={{ backgroundColor: subject?.color || '#gray' }}
                                                        ></div>
                                                        <span className={task.completed ? 'line-through text-gray-500' : ''}>{task.title}</span>
                                                        <span className={`px-2 py-1 rounded-full text-xs ${getPriorityColor(task.priority)}`}>
                                                            {task.priority === 'high' ? '高' : task.priority === 'medium' ? '中' : '低'}
                                                        </span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Subjects Tab */}
                            {activeTab === 'subjects' && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-gray-800">学科管理</h2>
                                    
                                    <div className="flex gap-3">
                                        <input
                                            type="text"
                                            value={newSubject}
                                            onChange={(e) => setNewSubject(e.target.value)}
                                            placeholder="输入学科名称"
                                            className="flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            onKeyPress={(e) => e.key === 'Enter' && addSubject()}
                                        />
                                        <button
                                            onClick={addSubject}
                                            className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
                                        >
                                            <Plus />
                                            添加学科
                                        </button>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {subjects.map(subject => {
                                            const subjectTasks = tasks.filter(t => t.subject === subject.name);
                                            const completedTasks = subjectTasks.filter(t => t.completed).length;
                                            
                                            return (
                                                <div key={subject.id} className="bg-white border rounded-lg p-4 hover:shadow-md transition-shadow">
                                                    <div className="flex items-center gap-3 mb-2">
                                                        <div 
                                                            className="w-4 h-4 rounded-full"
                                                            style={{ backgroundColor: subject.color }}
                                                        ></div>
                                                        <h3 className="font-semibold">{subject.name}</h3>
                                                    </div>
                                                    <p className="text-sm text-gray-600">
                                                        {subjectTasks.length} 个任务, {completedTasks} 个已完成
                                                    </p>
                                                    {subjectTasks.length > 0 && (
                                                        <div className="mt-2 bg-gray-200 rounded-full h-2">
                                                            <div 
                                                                className="bg-green-500 h-2 rounded-full transition-all"
                                                                style={{ width: `${(completedTasks / subjectTasks.length) * 100}%` }}
                                                            ></div>
                                                        </div>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            )}

                            {/* Tasks Tab */}
                            {activeTab === 'tasks' && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-gray-800">任务管理</h2>
                                    
                                    <div className="space-y-3">
                                        {tasks.map(task => {
                                            const subject = subjects.find(s => s.name === task.subject);
                                            return (
                                                <div key={task.id} className={`p-4 border rounded-lg ${task.completed ? 'bg-green-50 border-green-200' : 'bg-white'}`}>
                                                    <div className="flex items-start gap-3">
                                                        <button
                                                            onClick={() => toggleTask(task.id)}
                                                            className={`mt-1 w-5 h-5 rounded-full border-2 flex items-center justify-center ${
                                                                task.completed 
                                                                    ? 'bg-green-500 border-green-500 text-white' 
                                                                    : 'border-gray-300 hover:border-green-500'
                                                            }`}
                                                        >
                                                            {task.completed && <CheckCircle />}
                                                        </button>
                                                        
                                                        <div className="flex-1">
                                                            <div className="flex items-center gap-3 mb-2">
                                                                <h3 className={`font-semibold ${task.completed ? 'line-through text-gray-500' : ''}`}>
                                                                    {task.title}
                                                                </h3>
                                                                <span className={`px-2 py-1 rounded-full text-xs ${getPriorityColor(task.priority)}`}>
                                                                    {task.priority === 'high' ? '高优先级' : task.priority === 'medium' ? '中优先级' : '低优先级'}
                                                                </span>
                                                            </div>
                                                            
                                                            <div className="flex items-center gap-4 text-sm text-gray-600">
                                                                <div className="flex items-center gap-1">
                                                                    <div 
                                                                        className="w-3 h-3 rounded-full"
                                                                        style={{ backgroundColor: subject?.color || '#gray' }}
                                                                    ></div>
                                                                    {task.subject}
                                                                </div>
                                                                <div className="flex items-center gap-1">
                                                                    <Clock />
                                                                    {task.estimatedHours}小时
                                                                </div>
                                                                {task.deadline && (
                                                                    <div className="flex items-center gap-1">
                                                                        <Calendar />
                                                                        {task.deadline}
                                                                    </div>
                                                                )}
                                                            </div>
                                                            
                                                            {task.description && (
                                                                <p className="mt-2 text-sm text-gray-700">{task.description}</p>
                                                            )}
                                                        </div>
                                                        
                                                        <button
                                                            onClick={() => deleteTask(task.id)}
                                                            className="text-red-500 hover:text-red-700 p-1"
                                                        >
                                                            <XCircle />
                                                        </button>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                        
                                        {tasks.length === 0 && (
                                            <div className="text-center py-12 text-gray-500">
                                                <BookOpen />
                                                <p>还没有任务，开始添加你的第一个学习任务吧！</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}

                            {/* Add Task Tab */}
                            {activeTab === 'add' && (
                                <div className="space-y-6">
                                    <h2 className="text-2xl font-bold text-gray-800">添加新任务</h2>
                                    
                                    <div className="max-w-2xl space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">任务标题 *</label>
                                            <input
                                                type="text"
                                                value={newTask.title}
                                                onChange={(e) => setNewTask({...newTask, title: e.target.value})}
                                                placeholder="输入任务标题"
                                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">学科 *</label>
                                            <select
                                                value={newTask.subject}
                                                onChange={(e) => setNewTask({...newTask, subject: e.target.value})}
                                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            >
                                                <option value="">选择学科</option>
                                                {subjects.map(subject => (
                                                    <option key={subject.id} value={subject.name}>{subject.name}</option>
                                                ))}
                                            </select>
                                            {subjects.length === 0 && (
                                                <p className="text-sm text-gray-500 mt-1">请先在"学科管理"中添加学科</p>
                                            )}
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">优先级</label>
                                            <select
                                                value={newTask.priority}
                                                onChange={(e) => setNewTask({...newTask, priority: e.target.value})}
                                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            >
                                                <option value="low">低优先级</option>
                                                <option value="medium">中优先级</option>
                                                <option value="high">高优先级</option>
                                            </select>
                                        </div>

                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">截止日期</label>
                                                <input
                                                    type="date"
                                                    value={newTask.deadline}
                                                    onChange={(e) => setNewTask({...newTask, deadline: e.target.value})}
                                                    className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">预估时间（小时）</label>
                                                <input
                                                    type="number"
                                                    min="0.5"
                                                    step="0.5"
                                                    value={newTask.estimatedHours}
                                                    onChange={(e) => setNewTask({...newTask, estimatedHours: parseFloat(e.target.value)})}
                                                    className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                />
                                            </div>
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">任务描述</label>
                                            <textarea
                                                value={newTask.description}
                                                onChange={(e) => setNewTask({...newTask, description: e.target.value})}
                                                placeholder="描述任务详情..."
                                                rows={3}
                                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                            />
                                        </div>

                                        <button
                                            onClick={addTask}
                                            disabled={!newTask.title || !newTask.subject}
                                            className="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"
                                        >
                                            <Plus />
                                            添加任务
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<StudyPlanner />, document.getElementById('root'));
    </script>
</body>
</html>